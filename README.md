# SOLID-design-patterns — Лабораторная работа №06

## Описание

Программа реализует редактор подземелья для RPG-игры Balagur Fate 3. Позволяет размещать NPC (Медведь, Выпь, Выхухоль) на локации, сохранять и загружать их из файла, печатать список, а также запускать боевой режим с учётом заданных правил взаимодействия между персонажами.

## Используемые паттерны

- **Factory Method** — для создания NPC и загрузки их из файла.
- **Visitor** — для реализации логики боя между NPC.
- **Observer** — для логирования событий боя (в консоль и файл).

## Основной функционал

1. **Добавление NPC**
   - Каждый NPC имеет уникальное имя, координаты (x, y) в диапазоне 0–500, и тип (Bear, Heron, Desman).
2. **Сохранение и загрузка**
   - NPC сохраняются в текстовый файл, формат: `Тип Имя X Y`.
3. **Печать списка NPC**
   - Выводит на экран тип, имя и координаты каждого NPC.
4. **Боевой режим**
   - Все NPC сражаются друг с другом, если находятся в пределах заданной дальности.
   - Применяются правила совместимости:
     - Медведь убивает всех, кроме других медведей
     - Выпь никого не убивает
     - Выхухоль убивает только медведей
   - Убитый NPC не может нанести ответный удар.
   - События боя логируются через Observer (консоль и файл).

## Пример работы

1. Добавление NPC:
   ```cpp
   dungeon.addNPC(NPCFactory::createNPC("Bear", "Bear1", 100, 100));
   dungeon.addNPC(NPCFactory::createNPC("Heron", "Heron1", 110, 110));
   dungeon.addNPC(NPCFactory::createNPC("Desman", "Desman1", 120, 120));
   dungeon.addNPC(NPCFactory::createNPC("Bear", "Bear2", 130, 130));
   ```
2. Сохранение и загрузка:
   ```cpp
   dungeon.saveToFile("npcs.txt");
   dungeon.loadFromFile("npcs.txt");
   ```
3. Запуск боя:
   ```cpp
   auto consoleObs = std::make_shared<ConsoleObserver>();
   auto fileObs = std::make_shared<FileObserver>("log.txt");
   std::vector<std::shared_ptr<Observer>> observers = {consoleObs, fileObs};
   dungeon.battle(50.0, observers);
   ```

## Сборка и запуск

```bash
cd SOLID-design-patterns
mkdir build
cd build
cmake ..
make
./SOLID_design_patterns_exe
```

## Тестирование

В проекте реализовано 21 юнит-тест (Google Test), покрывающих все основные сценарии: создание NPC, валидация, правила боя, сохранение/загрузка, логирование событий.

## Структура проекта

- include/ — заголовочные файлы (NPC, паттерны, Dungeon)
- src/ — реализации классов
- tests/ — тесты Google Test
- main.cpp — пример использования

## Примечания

- Все события боя логируются в консоль и файл log.txt
- Координаты NPC валидируются (0–500)
- Убитый NPC не может атаковать в этом же раунде
